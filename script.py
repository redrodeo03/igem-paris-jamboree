import csv
import requests
from tqdm import tqdm


def get_team_info(team_id):
    url = f"https://api.igem.org/v1/teams/{team_id}"
    try:
        response = requests.get(url)
        if response.status_code != 200:
            print(f"Failed to get team info for team ID {team_id}. Status Code: {response.status_code}")
            return None
        return response.json()
    except requests.RequestException as e:
        print(f"Request failed for team ID {team_id}. Error: {e}")
        return None


def get_artifacts(team_id):
    url = f"https://api.igem.org/v1/teams/{team_id}/artifacts"
    try:
        response = requests.get(url)
        if response.status_code != 200:
            print(f"Failed to get artifacts for team ID {team_id}. Status Code: {response.status_code}")
            return []
        return response.json()
    except requests.RequestException as e:
        print(f"Request failed for team ID {team_id}. Error: {e}")
        return []


def main():
    team_ids = ["1319","1585","2020","2225","2702","3013","3456","3774","4138","4744","1443","1655","1907","2342","2647","3016","3386","3793","4159","4701","182","385","1352","2941","3872","4207","4831","4068","2867","2421","2815","3272","4089","1261","2217","2534","3244","3504","3743","4140","4586","4778","470","1571","4396","3656","1196","1341","1751","2044","2459","2547","2949","3981","1917","4808","4012","1098","1349","1601","1951","2255","2718","2915","3465","3788","4189","4582","3085","25","187","349","612","879","1161","871","960","102","2905","3445","3737","4166","4732","2145","3320","2457","1719","949","1281","178","538","874","1844","2385","3437","1200","1436","996","4503","1302","796","768","4780","1750","2270","438","578","891","1190","1502","2033","2357","939","1543","221","420","645","2252","3368","4186","4746","4738","1885","2226","2562","2928","3813","4334","2509","2826","3152","3576","3906","4006","4455","4895","2709","3201","3520","4034","4294","4810","1202","1456","1639","2058","2975","3626","2642","1530","727","993","1291","1806","2059","4579","2877","734","1416","1627","2097","2253","2657","3174","3569","3879","4342","2098","2458","1677","4714","665","2436","2187","2893","3301","3651","3851","375","26","452","4962","4770","4501","595","4880","830","1512","1109","923","2864","2894","56","80","184","135","259","381","589","2567","3143","2264","3598","984","1802","994","1283","752","78","751","3996","4290","426","435","475","641","900","1131","49","198","16","197","1438","1617","2482","4400","5004","2555","4799","2728","2371","2026","3394","1223","1458","1699","2091","2538","2938","4120","3399","4033","1264","1726","3202","1971","4717","1465","1758","2082","2201","2638","2926","3410","3900","4877","389","525","863","1172","1946","2234","2759","3003","4969","4021","4476","596","4403","2133","2879","2885","4413","4804","4824","3000","793","978","1263","956","1130","1471","1684","2004","1265","260","407","745","2860","3277","1846","1058","1407","1651","2041","2305","2708","3020","3471","3821","4128","4691","1117","1325","1675","2120","2368","2765","2972","3496","3852","4232","4616","4963","3512","1044","1303","3693","3874","1005","4722","3759","4221","1374","4861","999","2833","3887","4203","4657","4945","3120","4593","2028","2326","2548","2950","3329","3745","4204","4237","1405","1660","1891","2220","2717","3036","3506","3805","4117","4623","3784","4211","4737","2294","2670","3015","3514","3855","4423","4700","4007","63","79","201","820","1075","2954","4102","4510","4816","848","1148","1317","1686","1935","2307","2636","783","1114","1401","1733","1875","2411","2805","4708","1876","2409","2661","4485","53","2337","2786","3226","3364","4667","1521","1819","1073","1390","4906","2293","206","391","517","804","1129","1450","1813","2139","2433","2700","3175","3827","3590","3831","2185","1871","2811","3236","21","124","212","324","441","656","3260","165","213","4897","3141","3882","4329","439","489","3238","3699","3875","4146","4644","1513","2782","3197","3664","3742","4194","4612","792","1106","1550","2171","2515","2847","3208","3764","4364","4855","577","704","705","977","833","619","1195","1356","5024","4862","2248","4226","765","1854","37","218","339","459","902","640","1189","1444","2260","2605","3114","3629","3945","4437","4944","1236","107","148","131","59","137","338","436","476","490","620","773","1369","46","90","274","325","440","477","638","911","4491","4769","1484","1703","2148","3220","4872","4291","55","1248","2186","2465","2060","2404","2810","921","1184","1491","1732","1569","4614","1097","1421","1657","3279","3467","3796","4192","236","307","605","860","1215","4610","2566","1762","2103","2491","3270","3551","3956","4261","4674","2292","2809","2927","3648","3778","4131","826","2726","2096","1821","1728","1955","2376","753","1603","2329","2625","3054","3477","3944","4367","4902","2030","1282","29","84","247","396","442","1057","72","3812","4112","1779","1634","4024","695","987","1255","2172","2281","2631","2322","872","1230","776","4642","226","1472","1695","3834","4154","3905","4508","4611","3825","2892","803","1090","1522","2078","2206","3214","3588","825","2467","2872","2961","4740","1298","443","2156","2498","2758","1664","2166","5012","2271","159","669","831","1455","65","1144","918","643","952","2412","2846","2062","1848","1165","1547","1830","2045","2944","3363","3768","4136","4684","534","1552","998","1267","1834","1354","1746","770","527","1698","285","399","597","957","1021","1460","1595","2296","2561","2960","3419","3833","4322","4580","1931","2978","4133","836","1142","2880","73","4990","88","2161","2506","2624","2976","3661","3853","4308","4257","2494","3935","4495","47","1297","761","710","992","3276","4618","2382","2951","3431","4029","4151","4585","2580","2908","3452","3734","4127","1229","1495","1702","1945","2204","2727","3083","1251","662","3856","3144","858","1188","1445","2129","2249","2674","3115","3446","4201","4919","4242","4767","4469","4101","4459","2648","1718","4165","1837","1690","2331","1872","2160","2803","685","2184","1790","690","2435","444","478","315","91","15","364","626","975","2441","2444","2410","2698","3694","4431","2111","3877","4161","4587","4494","2752","2772","4651","2630","3130","3652","3844","4386","374","564","1067","1330","1716","2117","2355","2799","3046","3385","3841","4129","4811","678","194","1936","2587","2924","3583","3826","4369","4706","58","158","282","429","433","655","954","1204","1545","1880","1835","2464","2837","4046","4234","4646","68","562","895","1012","1315","1590","1962","1963","4766","3354","3898","4176","3060","3061","947","4649","2290","2843","3004","4515","4458","3704","3995","4281","983","2804","3893","2308","2737","378","3093","3480","3970","42","118","216","322","446","523","917","1122","1399","1615","3380","3946","4849","4390","1968","2330","2739","2940","1967","2406","2725","2952","794","1584","1301","4375","2146","2487","2679","2181","1294","522","92","191","613","838","1941","2203","2686","2916","3600","4035","4439","4888","320","1111","1486","1723","2511","105","251","365","4917","3692","4020","4440","2131","39","445","487","422","142","625","909","1216","1541","1847","2116","2500","2845","3211","703","812","1163","1413","1611","2042","4601","2448","2675","2983","3453","3766","4432","764","1173","1398","1586","1914","2324","2695","3039","3371","4339","4694","4253","1864","2074","2384","2820","2935","3550","3732","4113","772","541","4930","1861","2169","2641","3117","3498","4065","4881","3082","3466","3810","4338","1269","2570","3086","2523","846","1567","2419","849","1181","57","157","447","608","747","1150","1470","1621","2114","2295","3009","4229","4604","243","404","279","405","4846","2367","2832","3172","3702","3792","4475","4680","1100","1440","1777","1925","2446","2549","3245","3606","3790","4162","4765","2886","384","604","3257","2460","798","785","4870","4000","4288","4688","3769","2882","169","4481","1877","230","308","614","824","1042","1320","1749","2221","2536","2994","3417","4063","3500","3842","4493","2517","3938","982","1038","2585","2947","3458","3880","4270","2089","5005","5001","4852","4137","3254","1278","1870","1429","1799","2128","529","755","4736","410","582","1156","1539","1743","431","1110","1441","1800","1915","2524","2640","3042","916","1566","2776","1332","1859","2158","2438","2798","4031","4715","3222","23","660","1463","1725","2151","2442","1013","4285","777","1045","1430","1865","1978","2586","4404","1503","423","2688","3027","3427","3902","4370","839","4825","2753","3089","3593","3897","4275","3264","3596","3859","3858","2364","3840","698","586","637","1178","1426","545","845","2299","2629","3128","1141","3463","531","77","190","305","607","818","1085","1365","1597","1930","2361","2783","3171","3507","3748","4233","4720","4660","1227","2057","4157","4581","4891","152","3189","4058","4321","4597","1287","3050","4032","3659","3618","4087","4354","4678","4430","2415","2840","2948","3595","4723","2856","1646","2859","1827","714","4489","4797","4223","3622","1860","1909","2401","2588","2970","3362","3846","4669","1863","2899","4883","1671","4882","3313","1478","2075","3338","1528","1226","31","98","207","382","448","479","615","2251","2895","3281","3677","4066","4480","4999","1457","1850","2010","789","125","2574","2304","2652","3126","4249","4687","2667","150","203","337","1152","1362","1614","2398","3657","3963","4344","4757","862","1504","686","2346","2890","1693","2134","2466","1451","609","748","1014","1437","3978","4177","4761","4794","4837","3923","2746","4946","4041","2720","4774","4823","283","4696","366","544","211","330","3581","4061","4225","4725","524","733","1682","113","855","4241","3382","3816","4126","2982","3787","3414","2618","2219","3087","3219","3561","3776","4384","4752","1327","2394","4252","496","547","759","1084","1524","1714","2015","2414","4867","4813","4670","361","559","786","1314","1648","2254","2582","3071","3511","1092","1217","1428","1774","2054","2202","2592","3063","3644","3988","1119","1379","1899","2240","2764","3017","2578","3076","3746","3058","1889","2197","3077","3718","3973","4452","4676","2977","4664","4698","1286","4677","2639","1961","2527","1613","573","4183","1273","684","4666","4912","4927","2800","3241","4832","2984","3861","1293","661","580","805","1037","1393","1592","2036","2336","2533","3196","3711","4468","4595","1551","4900","3712","4511","1228","1368","1713","2012","2381","2632","3205","3378","3733","4169","4645","2855","3293","3535","403","233","3225","3420","3716","4236","4690","3867","4167","3461","2479","2802","3305","4303","4692","4695","275","94","2319","2609","3165","3765","4462","4829","2168","4958","2790","2773","4781","2743","4933","2320","2258","3285","3582","3971","4392","4879","4429","4836","3519","3889","4438","4693","3646","3982","4449","3121","3450","3848","4382","3011","3799","3401","3744","4391","1780","3110","3979","4359","4428","4898","1956","2318","2857","3163","4931","4838","333","4896","255","3103","1170","1395","1866","2173","2525","2814","408","2874","1862","2163","86","272","372","572","856","1194","1654","3564","4434","126","252","261","19","449","1321","200","143","1149","1893","2862","3559","316","515","4212","1944","280","432","2127","342","1404","1934","2278","4818","4239","1132","434","4056","4807","2282","4577","1616","2023","3102","3409","3933","4187","266","472","287","288","460","4952","83","2141","2849","3940","3980","1064","1387","1685","2378","3252","2363","2563","1313","1544","587","3106","4424","1096","3829","4122","498","664","935","1063","1477","2178","4070","4940","3665","4955","4921","989","1274","2568","2985","4149","4759","3137","2606","3402","3803","4840","3133","4516","4081","4980","1432","1706","1932","2317","2541","3078","3447","3883","4385","4609","4833","4427","2614","2358","2608","3209","3605","1940","2963","110","263","363","530","2925","277","800","799","2000","3235","2035","2245","730","885","351","623","907","1120","647","835","1069","1414","1740","2175","2335","2821","3303","3685","3915","4487","681","682","4650","3729","4180","4584","2595","2968","3635","3794","4388","1153","1454","1739","1985","2340","3478","4015","4274","4863","3592","1952","2268","1359","362","579","758","1049","1448","1858","2861","2233","3200","4869","3643","1999","3090","3573","3824","4305","746","400","610","739","1146","1377","1754","2094","3654","4953","2437","2564","3107","3421","3837","4371","145","238","584","4661","3433","1060","1709","2263","3084","3807","4345","271","127","210","358","622","797","1126","1312","1933","2403","2665","3185","3815","4655","2701","3080","4683","1911","979","1266","1662","2353","2550","2974","3411","3725","4245","1995","2377","1624","450","4398","4620","1747","1452","119","242","164","1028","852","1095","1715","1902","1938","2610","3041","3343","3962","4259","4721","52","249","331","542","901","1210","1419","1791","2109","2443","2683","3237","3624","3738","4139","4754","4599","736","988","1292","155","1233","1792","2124","2481","2692","3001","3349","3907","4351","1663","2067","1565","3647","1083","1447","1704","2095","2474","2671","3182","3892","4433","4805","3552","4011","4273","4977","5028","12","894","4044","368","549","823","1351","2170","2112","1337","1845","2107","2478","2697","3246","3668","4025","2266","2602","3282","3619","3955","4373","4745","927","802","540","1103","1523","1755","2796","3170","3760","4156","4788","3986","4330","4331","4332","4512","4300","4301","497","646","953","1080","1326","1640","1998","2300","2664","3151","2792","3122","3726","3255","5019","4517","2714","1076","1027","1434","2092","2213","2613","2906","3340","3710","4123","1670","2238","930","5029","1071","1329","1650","1964","2560","3228","3758","4729","866","24","290","468","666","1563","2767","4348","4608","2164","976","1235","2658","4010","4751","832","2691","1929","2470","4819","4415","4442","2493","694","50","85","1394","2140","2395","2681","4049","4875","4682","4097","843","2887","593","536","258","1285","1658","2052","2571","129","352","1197","1392","1606","616","326","62","328","134","4514","4047","20","138","270","377","463","618","880","1077","1519","1843","2105","2301","2813","3251","4037","4143","4858","2633","2919","3359","3719","4135","1562","1785","2104","2274","2829","3297","4022","1256","1608","1991","2230","2543","2932","3376","3728","4150","4652","36","101","202","311","632","814","1187","1420","1626","2099","2375","2873","3942","451","40","144","453","1464","4856","1805","64","146","269","306","621","877","1177","1370","3043","3800","4262","1737","2034","2362","2678","128","181","415","466","480","493","511","779","1179","1391","1705","2100","2429","2649","2957","3621","4074","4320","4764","4641","3306","955","3470","3721","4200","417","1249","2666","3147","3700","4473","4697","139","2870","3028","3636","3845","3565","4088","2488","689","199","3587","1099","3218","3476","3947","4185","4665","2125","2405","4051","1006","2323","2722","3113","4497","4574","5016","1342","1653","1950","2256","591","1787","599","3253","4886","4779","788","1145","1520","1701","1958","2257","2740","3022","3341","3731","4134","4605","4606","5022","4885","905","3134","3524","4003","4289","1252","1643","1894","2209","2597","2989","3492","3964","4125","1331","1628","2991","3518","3811","4709","35","2088","2365","2557","3139","3408","3735","4164","4613","5011","2687","3045","3931","4374","2142","3928","2348","2850","3204","4934","2546","3029","3830","4358","1920","2275","2762","2997","3490","3771","4171","2046","4446","4943","188","332","539","887","1017","1415","1694","1974","2262","2599","3256","3370","3736","713","985","1276","2694","3886","4072","4258","4753","1757","1485","4827","1509","1666","1947","2302","2542","2913","3350","3894","4121","1982","2288","4635","2967","3611","3896","4220","2817","2824","262","414","558","931","1347","1136","174","302","1185","1895","2205","2797","3206","104","701","2831","1511","3951","3513","4376","990","1290","2473","4901","4077","1555","1649","3631","3873","4205","4705","4724","4800","3234","3384","3753","4119","1633","1942","2208","2781","3335","3756","4173","4815","1402","1180","1160","4297","1981","2280","2705","4656","4040","4421","3868","4343","4790","3522","3994","4045","903","2182","2431","1857","2108","2659","3048","3957","418","575","1231","912","1417","2019","2396","2806","3269","3948","2715","2992","3356","828","3675","4017","2347","2707","3937","4309","4801","774","1041","1467","1618","1957","4636","889","2635","2073","2354","2774","3040","3486","3835","4336","1082","3762","639","822","1424","1840","1970","2265","2754","1841","117","256","1676","2130","2818","3250","4053","4830","817","1157","2316","1507","1125","4782","4960","1532","1789","1997","2440","2653","3064","3396","4016","4414","1515","4850","1897","2447","3198","3927","2819","2807","1118","1335","1828","2516","2896","3299","4083","4389","2155","2399","2544","2981","3351","3722","4199","4762","3388","3779","4974","4854","4060","4461","4822","4377","4079","3691","4482","868","869","651","650","116","195","411","624","896","1104","1510","1769","2040","2350","2751","3268","3682","276","416","4812","1867","2122","4820","2808","2495","3289","3658","4082","4397","850","2956","4039","4478","1756","1990","2400","3267","5027","2939","3412","3783","4341","469","485","4884","1910","1268","1717","2650","4103","3309","3696","204","392","602","941","1040","2747","1219","4865","1207","594","737","1059","1439","1679","2047","2314","2615","2904","3328","3777","4193","4711","4596","3785","1558","1446","1659","1980","2450","2757","3183","4932","1710","424","653","944","18","136","257","4602","910","606","914","1137","1403","1678","2043","2510","2738","3579","3786","4216","329","1155","1372","1707","2039","2454","1622","2053","2198","2616","3176","3464","3839","4287","4639","5017","4973","4118","4505","1277","14","346","819","1031","1378","1689","1989","2243","2601","3081","3645","4298","4713","4638","904","598","581","120","548","811","1128","1505","1815","2456","3213","100","454","4950","1272","41","376","488","648","933","1043","1506","87","922","2056","2518","3961","4971","4284","4926","1548","1833","2084","2476","2785","3308","3666","3953","2565","228","4923","4936","3038","97","4457","2483","3023","627","929","1224","1481","1482","455","43","160","760","2037","1768","45","76","456","481","491","2432","4686","3642","2359","4743","4814","3021","3503","3863","4340","1986","4318","38","154","217","334","437","630","932","1225","1422","1772","1988","2228","2696","2966","3439","4008","4894","3683","3430","3720","4206","4784","3243","3797","3007","3457","214","309","4728","631","781","1121","1435","1831","2064","2484","2612","3056","3515","3767","4347","4996","667","1295","1304","4734","4513","2210","2572","2937","3395","3820","4405","4965","1476","1708","2338","2645","3224","3366","4509","4689","915","486","96","2655","840","1154","1501","1729","2077","2390","2716","3275","4052","44","278","457","1878","2194","2540","3247","122","2031","3010","3795","3157","2741","345","3614","3346","3724","4130","4588","1721","2126","2604","2993","2503","4806","4401","4402","3860","4293","4741","2749","3670","3857","4460","3173","588","787","1206","1556","2101","1469","4622","2897","2962","3941","60","2115","2119","924","1002","696","1869","1665","3273","3154","3194","2888","1010","1373","1959","2559","4014","4632","4847","2143","4937","1375","1919","2611","3221","3544","3977","4383","4817","2334","3672","1072","1462","1724","1778","1371","1720","3772","4263","4621","2733","1972","2360","2080","2366","2325","3100","3333","2763","1087","1796","2276","1672","3775","2239","1979","2553","3091","3616","4090","2627","4583","237","343","899","1088","1475","1638","2018","2449","3044","3602","4059","4868","2321","3127","2291","3166","3684","884","4948","4317","4299","3263","3195","873","1143","897","514","2816","2453","1531","1839","4887","4873","4874","4889","4890","3159","3239","2315","2787","4594","2132","2152","3278","3454","3755","4115","3298","3526","3999","4248","4093","3135","3525","3992","3296","3527","3916","4276","4099","3136","3585","3998","4028","4004","4278","4096","4005","3633","3584","3991","4277","4030","3074","995","719","717","718","1270","4411","246","386","1498","2016","2508","3181","4451","4939","809","1052","1051","986","1260","1607","1928","2200","3148","1003","1288","1744","1667","2745","4672","2507","2684","3156","3594","3798","4255","3295","3521","3993","4280","4942","2836","3109","2794","4521","2472","2830","4086","2311","3288","3888","185","387","771","567","1026","1453","1642","1969","2285","2552","2996","3365","3714","4181","4760","406","1479","1759","2211","2162","2704","3055","3460","3741","4328","4589","1299","1793","1794","2569","1812","2393","2532","133","245","323","462","782","1965","1669","4911","2865","3132","3497","4712","1892","2224","2551","3240","3628","3990","4224","1280","3262","162","829","4267","4643","2703","2909","3373","3836","4316","3012","180","663","675","716","48","471","1804","5014","5002","5003","5013","5009","5000","5008","3284","1948","2878","2244","2593","223","353","2876","3258","3697","4009","4466","4951","847","1218","1692","2027","2485","2868","1499","380","1766","2144","2235","2835","3024","3440","4071","4214","4658","4647","1382","1810","1908","2196","2596","2930","3428","3802","4235","2923","521","2497","2848","3014","3379","3780","4575","2102","1300","356","628","925","2844","2929","3634","3903","997","1271","4845","4909","4929","4904","4908","4279","4251","2216","2690","3031","1147","1508","3389","3952","4268","292","1431","767","1030","827","1032","4785","4747","4809","4739","4266","1943","2492","2591","2986","3423","3914","4425","4470","4124","1814","4864","1826","2113","2379","240","4915","1115","1736","1996","2417","3140","3814","4488","2793","4230","4617","629","806","1061","1333","1926","2298","2748","3179","3502","3960","4395","1993","2942","4839","893","1016","1340","1591","1883","2214","2750","3575","3976","4265","4826","1641","3686","4283","4844","2418","1687","3142","3487","3740","4325","3876","3229","1350","1884","2232","2788","2912","3360","3838","4286","4653","1722","3895","2673","3125","61","4673","1275","4484","2349","2576","3019","1253","1610","1898","2229","2539","2921","3352","3717","4648","2943","3413","3871","4219","2383","1473","1727","2011","1852","2069","2471","2834","2959","4147","4607","1903","427","633","942","1366","1734","2055","2761","3292","4092","4506","946","945","4464","1636","1904","2246","2719","3809","4260","1629","1905","784","1343","2520","2934","3653","4179","4633","1767","1674","1992","1166","4763","2434","2760","3149","4447","3290","3917","2081","1801","2061","2408","2946","4629","4314","4735","4324","2839","3304","3727","4141","4998","4170","2973","3505","3866","4213","4624","1001","1296","373","1517","2579","3983","4986","4987","5015","4988","4502","4979","4153","3984","3959","4793","3899","4989","22","132","289","500","563","821","1020","1361","1582","2110","2407","2637","3112","3939","4362","4703","938","1696","4627","1921","2933","3468","3715","4152","2328","2644","4064","4520","2279","1887","749","1015","2496","179","317","225","519","769","1053","1339","1765","2505","3259","4019","4419","4828","458","336","543","51","121","193","395","649","934","1139","1529","1632","1949","2729","1924","1360","4786","2863","4787","2374","2730","3018","3475","3823","4228","1922","3094","3483","3847","4272","33","357","464","483","601","926","1019","1559","1760","2048","2469","2699","2910","3949","4479","4615","192","600","161","1364","1587","2668","4768","1937","3570","3930","4197","2369","980","2590","3318","3599","1254","1788","2090","875","1808","1984","2227","4843","4841","13","108","189","341","533","766","1024","1328","1797","2247","1923","2558","2980","3369","3924","4307","4634","574","740","1116","1311","1700","1918","2250","2583","2979","3374","4771","837","1025","4772","4871","4654","556","775","1022","4750","881","1123","2065","2356","2812","3972","4160","4905","1159","115","175","2306","2643","2918","3407","3806","4361","950","1029","1483","1680","1882","2372","2689","3096","3510","3757","4208","4834","1186","1427","1818","2087","2416","2875","3212","2920","54","473","2267","2685","4184","808","1055","1497","1602","1976","2380","2770","3187","3429","3985","398","1583","1890","1316","1781","2273","3037","4365","1492","1761","3168","3002","3589","3781","151","291","494","568","801","688","229","419","571","1222","2998","248","1832","2389","2779","3072","4755","4443","4422","1741","2014","3317","859","566","888","1140","1480","3097","3761","4350","4733","4796","4296","1770","2029","2402","2676","4080","1367","1823","857","1221","1213","1564","2150","2287","2598","2969","3392","3817","4256","4619","4394","1518","2002","2344","4094","268","1193","1500","1745","2176","2428","2780","2945","3436","3954","4269","4710","1730","2289","2723","2425","1018","1336","1598","1954","2332","2842","3111","3601","4417","1176","1384","1763","2068","2766","943","2093","2341","2654","981","1257","1203","239","301","676","1135","919","1953","2386","2706","2917","4465","4984","2455","2871","3190","3617","4247","1560","1775","2071","2223","2628","3008","3426","3808","4190","4592","2159","1353","66","106","209","321","461","484","644","726","1062","1829","1346","112","111","743","1113","265","327","611","936","1212","1324","1712","1916","2869","3249","3669","920","1386","1842","2085","2212","2881","3310","3613","4026","509","3188","1091","4335","1537","2013","2286","2617","3034","3819","4773","1535","2025","2646","3035","3404","1199","1782","2123","1355","2352","2677","3424","3910","4412","4975","1086","1514","1776","4349","3124","3215","1620","2575","3242","890","1138","1383","1635","1939","2392","4337","1105","3701","1896","3687","4914","4076","1182","1344","2050","4749","4310","4866","4899","1466","1619","1927","2424","2711","2971","3353","3709","4450","2427","2712","715","310","617","865","335","1209","1205","898","1380","1681","1987","2468","2828","2955","3627","3713","4436","1208","1697","2607","3088","3932","867","2672","3026","3493","3862","4346","4726","2215","2651","2958","196","348","551","908","1318","4959","4085","1851","2007","4716","4323","4949","1489","1783","2032","2477","2825","3302","3679","3965","4483","4860","1644","2138","961","2858","1538","3854","4368","2430","1410","1811","71","882","3033","3630","3789","4357","1731","360","535","657","1542","851","1588","2236","2499","4893","1494","1838","2063","250","2086","2461","2662","3191","2660","3749","2076","4472","4727","1786","284","554","4435","4983","2343","3101","1094","1525","1825","1975","5023","3482","3782","4209","4685","4075","3294","4675","4418","81","173","300","516","1151","526","2521","4043","731","1065","1604","553","729","123","163","147","149","153","109","3929","2284","4758","2022","2710","3075","3558","3750","4467","4848","2024","2008","2777","3425","4215","4598","234","319","642","1164","1400","1652","2327","3271","807","3878","3612","4036","4444","2118","3484","3791","2581","2106","854","2180","2504","4671","3287","4453","367","510","1973","1033","1381","1688","2003","2423","2669","3934","4378","273","379","592","3105","864","3169","205","570","397","2179","2397","2732","2911","3347","3723","4132","4578","512","842","4857","4381","3104","2222","2838","2147","2199","2724","1078","2486","2771","3095","3890","4590","2149","2603","4091","4496","5007","1262","886","3280","2136","603","32","82","176","371","1593","2009","2242","2768","3099","3912","4231","4679","557","741","1363","507","742","1079","1376","1594","2001","2241","2769","3073","3336","3958","4240","4659","1074","183","369","1348","1784","2072","2519","2537","1388","2522","2594","3145","1487","1966","2451","2742","313","518","778","1124","1461","1631","2070","791","89","208","390","654","844","1162","1418","1820","3217","467","482","492","815","412","813","1048","1496","3804","4238","4803","672","636","951","937","2351","2736","3339","569","876","1214","3443","4707","3265","3610","3989","4387","4662","2490","30","141","222","401","465","565","754","1158","763","1112","1468","1554","1742","2017","2269","2656","1322","1673","2005","1345","1449","2006","674","235","340","1490","254","3155","4050","1773","1983","2259","2622","3032","3416","3904","4380","4719","2621","11","156","231","635","732","1011","1357","1600","1879","2272","2535","3192","3615","3975","4477","4853","264","17","555","303","1488","4625","513","728","2775","3053","3438","4372","304","4663","546","883","1023","1493","1913","2387","3286","3747","4244","1259","2755","699","659","103","177","299","528","780","1093","1459","1442","1855","1994","2463","2841","3051","3625","3752","4210","4600","3580","520","4158","215","314","590","1232","892","1408","1711","2165","2391","2682","3123","4023","4441","4821","253","962","394","552","906","1169","1385","1605","2135","2195","2663","227","27","93","241","359","576","790","1039","1323","1645","2137","2475","2573","2995","3381","3843","4393","4704","795","4748","114","4271","388","1068","816","1735","4842","413","3316","2177","4702","940","1201","1748","2420","2626","3146","1977","583","928","3057","3184","3997","1000","1258","4013","4859","560","861","1081","1334","1647","2462","2789","3098","3562","3763","4144","4630","1561","1753","4631","1409","1795","2333","2066","2680","3059","3517","3773","4174","67","130","220","318","634","762","1056","5006","537","354","948","1175","1406","1683","1900","2452","2589","3116","4062","4366","4916","1803","721","4409","4410","2513","3578","3909","4407","4408","3311","3577","3908","4399","2514","2889","3153","3638","2512","2827","3150","2167","1423","1809","2083","2413","2577","4078","4217","4681","3138","4795","4903","4730","4191","4073","4188","3568","3698","3160","3161","3926","3921","3560","4172","4994","3925","4155","4995","3158","3523","4002","3312","2898","1824","1906","2309","2619","3030","4054","4463","4968","2791","3052","3331","3832","4182","4835","421","658","750","1036","1412","1960","2310","2623","2922","3332","3739","4195","4907","1534","1070","735","393","652","810","1211","1396","1856","2121","2795","4486","4947","4961","2999","219","3822","4218","4789","4304","4105","1526","1807","2489","1127","4055","1397","1411","1589","2823","1474","4876","4292","697","4941","561","402","738","1054","1433","1668","1886","2207","2721","2965","3398","3730","4202","4628","4175","4776","2277","2556","2936","3885","4227","4591","3406"]
    all_data = []

    for team_id in tqdm(team_ids, desc="Processing teams"):
        team_info = get_team_info(team_id)
        artifacts = get_artifacts(team_id)

        if team_info and artifacts:
            artifact_data = artifacts[0].get("metadata")
            if artifact_data and artifact_data.get("title"):
                combined_data = {
                    "teamID": artifacts[0].get("teamID"),
                    "teamName": team_info.get("name"),
                    "teamTrack": team_info.get("track"),
                    "region": team_info.get("region"),
                    "country": team_info.get("country"),
                    "schools": team_info.get("schools"),
                    "kind": team_info.get("kind"),
                    "title": artifact_data.get("title"),
                    "abstract": artifact_data.get("abstract"),
                    "year": team_info.get("year"),
                }
                all_data.append(combined_data)

    if not all_data:
        print("No data to write to CSV.")
        return

    # Writing to CSV
    with open("teams_artifacts.csv", "w", newline="") as file:
        fieldnames = ["teamID", "teamName", "teamTrack", "region","country", "schools","kind", "title", "abstract","year"]
        writer = csv.DictWriter(file, fieldnames=fieldnames)
        writer.writeheader()
        for data in tqdm(all_data, desc="Writing to CSV"):
            writer.writerow(data)


if __name__ == "__main__":
    main()
